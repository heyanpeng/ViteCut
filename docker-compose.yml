# ViteCut 后端 API - 使用云服务器上的 MySQL
# 在项目根目录创建 .env 配置 MYSQL_HOST、MYSQL_USER、MYSQL_PASSWORD、MYSQL_DATABASE
# 构建: docker compose build  启动: docker compose up -d

services:
  vitecut-api:
    build:
      context: .
      dockerfile: packages/api/Dockerfile
    container_name: vitecut-api
    restart: unless-stopped
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - PORT=3001
      - MYSQL_HOST=${MYSQL_HOST}
      - MYSQL_PORT=${MYSQL_PORT:-3306}
      - MYSQL_USER=${MYSQL_USER}
      - MYSQL_PASSWORD=${MYSQL_PASSWORD}
      - MYSQL_DATABASE=${MYSQL_DATABASE:-vitecut}
    volumes:
      - vitecut-uploads:/app/packages/api/uploads
      - vitecut-output:/app/packages/api/output

volumes:
  vitecut-uploads:
  vitecut-output:
